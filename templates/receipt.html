{% extends "base.html" %}
{% block content %}

<div class="max-w-xl mx-auto mt-10 bg-white shadow-2xl rounded-2xl p-8">
<h2 class="text-3xl font-bold text-gray-800 mb-8 text-center border-b pb-3">Official Payment Receipt</h2>

<div class="space-y-4 text-gray-700">
    <!-- Student Info -->
    <div class="border-b pb-3 mb-3">
        <p class="text-lg font-semibold text-indigo-700">Student Details</p>
        <p><strong>Name:</strong> {{ payment.student.full_name }}</p>
        <p><strong>Class:</strong> {{ payment.student.student_class }}</p>
    </div>

    <!-- Payment Details -->
    <p><strong>Receipt ID:</strong> <span class="font-semibold">{{ payment.id }}</span></p>
    <p><strong>Date Paid:</strong> {{ payment.payment_date.strftime('%Y-%m-%d %I:%M %p') }}</p>
    <p><strong>Payment Type:</strong> {{ payment.payment_type }}</p>
    <p><strong>Term:</strong> {{ payment.term }}</p>
    <p><strong>Session:</strong> {{ payment.session }}</p>

    <div class="border-t border-b py-3 mt-4">
        <p class="text-xl font-bold flex justify-between">
            <span>Amount Paid:</span>
            <span class="text-green-600">
                ₦{{ "{:,.2f}".format(payment.amount_paid / 100) }}
            </span>
        </p>
    </div>
    
    <!-- FEE ACCOUNT SUMMARY (NEW) -->
    <h3 class="text-lg font-semibold text-gray-800 pt-4">Fee Summary</h3>
    <div class="space-y-2 pt-2">
        <div class="flex justify-between text-sm">
            <span class="text-gray-600">Expected Class Fees:</span>
            <span class="font-medium text-gray-800">
                ₦{{ "{:,.2f}".format(expected_amount / 100) }}
            </span>
        </div>
        
        <div class="flex justify-between text-sm">
            <span class="text-gray-600">Total Paid to Date:</span>
            <span class="font-medium text-gray-800">
                ₦{{ "{:,.2f}".format(total_paid / 100) }}
            </span>
        </div>

        <div class="flex justify-between border-t border-gray-300 pt-3">
            <span class="text-lg font-bold">Outstanding Balance:</span>
            {% if outstanding_balance > 0 %}
                <span class="text-xl font-extrabold text-red-600">
                    ₦{{ "{:,.2f}".format(outstanding_balance / 100) }}
                </span>
            {% else %}
                <span class="text-xl font-extrabold text-green-600">₦0.00 (Cleared)</span>
            {% endif %}
        </div>
    </div>
    
</div>

<div class="mt-8 flex justify-center space-x-4">
    <button onclick="window.print()"
            class="bg-green-600 text-white px-5 py-2 rounded-lg shadow hover:bg-green-700 transition">
        Print Receipt
    </button>
    <a href="{{ url_for('download_receipt', payment_id=payment.id) }}"
       class="bg-blue-600 text-white px-5 py-2 rounded-lg shadow hover:bg-blue-700 transition">
        Download PDF
    </a>
</div>

</div>
{% endblock %}
